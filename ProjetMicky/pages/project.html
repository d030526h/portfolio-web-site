<section id="p-project">
  <div class="orb" style="width:600px;height:600px;background:#EDECEA;top:-80px;right:-100px;filter:blur(140px);opacity:.75;"></div>
  <div class="proj-detail-inner">

    <!-- Breadcrumb -->
    <div class="reveal" style="margin-bottom:30px;">
      <a href="/portfolio" class="breadcrumb" data-route="portfolio">← Retour au portfolio</a>
    </div>

    <!-- Hero projet -->
    <div class="reveal proj-detail-hero">
      <div class="pd-preview">
        <div class="play-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="#fff"><path d="M8 5v14l11-7z"/></svg></div>
        <div class="pd-year-badge" id="pd-year"></div>
      </div>
      <div class="pd-hero-info">
        <div class="modal-tags" id="pd-tags" style="margin-bottom:14px;"></div>
        <h1 class="pd-title" id="pd-title"></h1>
        <p class="pd-client" id="pd-client"></p>
        <p class="pd-desc" id="pd-desc"></p>
        <div class="pd-cta">
          <a href="/portfolio" class="pd-back-link" data-route="portfolio">Voir tous les projets</a>
        </div>
      </div>
    </div>

    <!-- Stats -->
    <div class="reveal pd-section" style="transition-delay:.1s;">
      <p class="pd-section-title">Détails du projet</p>
      <div class="pd-stats-grid" id="pd-stats"></div>
    </div>

    <!-- Outils -->
    <div class="reveal pd-section" style="transition-delay:.18s;">
      <p class="pd-section-title">Outils utilisés</p>
      <div class="modal-tools" id="pd-tools"></div>
    </div>

    <!-- ═══ GALERIE APERÇUS ANIMÉE ═══ -->
    <div class="reveal pd-section" style="transition-delay:.26s;">
      <p class="pd-section-title">Aperçus</p>
      <div class="pd-gallery" id="pd-gallery">
        <!-- Injecté par renderProject -->
      </div>
    </div>

    <!-- Nav projets -->
    <div class="reveal pd-nav-projects" id="pd-nav-projects" style="transition-delay:.34s;"></div>
  </div>
  <div class="ft">© 2026 Micky Valat</div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <button class="lb-close" onclick="closeLightbox()">✕</button>
    <img id="lb-img" src="" alt=""/>
    <div class="lb-nav">
      <button id="lb-prev" onclick="lbNav(-1,event)">←</button>
      <span id="lb-counter"></span>
      <button id="lb-next" onclick="lbNav(1,event)">→</button>
    </div>
  </div>

  <script>
  // ── Lightbox ──────────────────────────────────────────────────────────────
  var lbImages = [];
  var lbIndex  = 0;

  function openLightbox(imgs, i) {
    lbImages = imgs; lbIndex = i;
    var lb = document.getElementById('lightbox');
    document.getElementById('lb-img').src = imgs[i];
    document.getElementById('lb-counter').textContent = (i+1) + ' / ' + imgs.length;
    lb.classList.add('open');
    document.body.style.overflow = 'hidden';
  }
  function closeLightbox() {
    document.getElementById('lightbox').classList.remove('open');
    document.body.style.overflow = '';
  }
  function lbNav(dir, e) {
    if (e) e.stopPropagation();
    lbIndex = (lbIndex + dir + lbImages.length) % lbImages.length;
    document.getElementById('lb-img').style.opacity = '0';
    setTimeout(function() {
      document.getElementById('lb-img').src = lbImages[lbIndex];
      document.getElementById('lb-counter').textContent = (lbIndex+1) + ' / ' + lbImages.length;
      document.getElementById('lb-img').style.opacity = '1';
    }, 160);
  }
  document.addEventListener('keydown', function(e) {
    var lb = document.getElementById('lightbox');
    if (!lb || !lb.classList.contains('open')) return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowRight') lbNav(1, null);
    if (e.key === 'ArrowLeft')  lbNav(-1, null);
  });
  </script>
</section>