<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Micky Valat — Monteur Vidéo</title>

  <base href="/ProjetMicky/"/>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@300;400;500;600;700&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="css/styles.css"/>

  <!-- Anti-FOUC : masque le viewport jusqu'au premier paint CSS -->
  <style>
    #viewport { opacity: 0; }
  </style>

  <script>
    window.BASE       = '/ProjetMicky';
    window.ASSET_BASE = '/ProjetMicky/';
  </script>

  <svg style="position:absolute;width:0;height:0;overflow:hidden;" aria-hidden="true">
    <defs>
      <filter id="glass-filter" x="-20%" y="-20%" width="140%" height="140%"
              color-interpolation-filters="sRGB">
        <feImage id="glass-map" x="-20%" y="-20%" width="140%" height="140%" result="map"/>
        <feGaussianBlur in="SourceGraphic" stdDeviation="0.012" result="blur"/>
        <feDisplacementMap
          in="blur" in2="map"
          scale="18"
          xChannelSelector="R"
          yChannelSelector="G"
          result="displaced"/>
        <feComposite in="displaced" in2="SourceGraphic" operator="in"/>
      </filter>
      <filter id="glass-filter-fb" x="-10%" y="-10%" width="120%" height="120%">
        <feTurbulence type="turbulence" baseFrequency="0.018 0.014"
                      numOctaves="3" seed="8" result="turb"/>
        <feDisplacementMap in="SourceGraphic" in2="turb"
                           scale="6"
                           xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    </defs>
  </svg>
</head>

<body>

  <div id="cur"></div>

  <!-- ← render-loader DANS le body -->
  <div id="render-loader">
    <div class="rl-inner">
      <div class="rl-top">
        <span class="rl-label">Chargement du projet</span>
        <span class="rl-pct" id="rl-pct">0%</span>
      </div>
      <div class="rl-track">
        <div class="rl-bar" id="rl-bar"></div>
      </div>
      <div class="rl-meta" id="rl-meta">Initialisation…</div>
    </div>
  </div>

  <nav id="nav">
    <a class="nav-logo" href="/" data-route="hero">Micky Valat</a>
    <div class="nav-links">
      <a class="nav-link" data-route="hero"      href="/">Accueil</a>
      <span class="nav-sep"></span>
      <a class="nav-link" data-route="about"     href="/about">À propos</a>
      <span class="nav-sep"></span>
      <a class="nav-link" data-route="portfolio" href="/portfolio">Portfolio</a>
      <span class="nav-sep"></span>
      <a class="nav-link" data-route="contact"   href="/contact">Contact</a>
    </div>
    <div class="nav-right">
      <div class="lg-wrap" style="border-radius:100px;">
        <div class="lg-distort" style="border-radius:100px;"></div>
        <a class="lg-btn" href="/contact" data-route="contact">Me contacter</a>
      </div>
    </div>
  </nav>

  <div id="mob-nav">
    <button class="mob-item" data-route="hero"      onclick="router.go('hero')">Accueil</button>
    <button class="mob-item" data-route="about"     onclick="router.go('about')">À propos</button>
    <button class="mob-item" data-route="portfolio" onclick="router.go('portfolio')">Portfolio</button>
    <button class="mob-item" data-route="contact"   onclick="router.go('contact')">Contact</button>
  </div>

  <div id="viewport"></div>

  <script>
    // ── Révèle le viewport après le premier paint ──
    document.addEventListener('DOMContentLoaded', function() {
      requestAnimationFrame(function() {
        requestAnimationFrame(function() {
          var vp = document.getElementById('viewport');
          if (vp) {
            vp.style.transition = 'opacity .3s ease';
            vp.style.opacity    = '1';
          }
        });
      });
    });

    // ── Normal map glass filter ──
    (function() {
      var feImg = document.getElementById('glass-map');
      if (!feImg) return;
      fetch('https://essykings.github.io/JavaScript/map.png')
        .then(function(r) { return r.blob(); })
        .then(function(blob) {
          feImg.setAttribute('href', URL.createObjectURL(blob));
        })
        .catch(function() {
          document.querySelectorAll('.lg-distort').forEach(function(el) {
            el.style.backdropFilter = 'url(#glass-filter-fb) blur(1px)';
            el.style.webkitBackdropFilter = 'url(#glass-filter-fb) blur(1px)';
          });
        });
    })();

    // ── Skeleton loader images ──
    document.addEventListener('load', function(e) {
      if (e.target.tagName === 'IMG') {
        e.target.classList.add('loaded');
        var thumb = e.target.closest('.proj-thumb');
        if (thumb) thumb.classList.add('img-loaded');
      }
    }, true);
  </script>

  <script src="javascript/main.js"></script>
  <script src="javascript/router.js"></script>

</body>
</html>
